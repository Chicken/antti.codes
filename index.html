<!DOCTYPE html>

<html lang="en">

<head>
    <title>antti.codes</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="language" content="en_us">
    <meta name="theme-color" content="#090609">
    <meta name="keywords"
        content="antti,ellila,ellilÃ¤,antti.codes,developer,programmer,sysadmin,homepage,contact,coding">
    <meta name="description" content="antti.codes homepage" />

    <meta name="og:title" content="antti.codes" />
    <meta name="og:url" content="https://antti.codes/" />
    <meta name="og:type" content="website">
    <meta name="og:locale" content="en_us">
    <meta name="og:email" content="antti@antti.codes" />

    <link rel="preload" href="./assets/SpaceMono.ttf" as="font" type="font/ttf" crossorigin>

    <style>
        @font-face {
            font-family: SpaceMono;
            src: url("./assets/SpaceMono.ttf");
            font-display: swap;
        }

        :root {
            line-height: 1.5;
            font-size: 16px;
            font-family: SpaceMono, monospace;
            font-variant-ligatures: no-common-ligatures;

            --text: #fafafa;
            --subtext: #dadada;
            --background: #090609;
            --primary: #b94680;
            --secondary: #1a0a0a;
            --accent: #ed6eed;
        }

        body {
            margin: 2em auto;
            max-width: 800px;
            padding: 1em;
            margin-bottom: 6em;

            display: flex;
            flex-direction: column;

            text-align: justify;
            font-kerning: normal;

            background-color: var(--background);
            color: var(--text);
        }

        h1,
        h2,
        h3 {
            align-self: first baseline;
            line-height: 1.2;
            background: linear-gradient(30deg, var(--primary), var(--accent));
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
        }

        h3 {
            margin-bottom: 0.5em;
        }

        h1 {
            align-self: center;
        }

        p {
            margin-top: 4px;
            margin-bottom: 4px;
        }

        a {
            color: var(--text);
        }

        ul {
            margin-top: 8px;
            margin-left: 28px;
            padding-left: 0px;
        }

        li {
            margin-bottom: 4px;
            text-align: left;
        }

        ul>li {
            list-style-type: square;
        }

        ul>li>div {
            display: flex;
            flex-direction: row;
            align-items: center;
        }

        code {
            font-size: 90%;
            filter: brightness(0.9);
            backdrop-filter: brightness(0.7);
            border-radius: 2px;
            padding: 3px;
            white-space: pre;
            font-family: SpaceMono, monospace;
        }

        i {
            padding-right: 1px;
        }

        img {
            width: 100%;
            border-radius: 6px
        }

        nav {
            align-self: center;
            display: flex;
            flex-direction: row;
            justify-content: center;
            gap: 0.5em 2em;
            flex-wrap: wrap;
        }

        nav>a {
            color: var(--primary);
            text-decoration: none;
        }

        nav>a::before {
            color: var(--text);
            padding-right: 2px;
            font-size: 110%;
            content: "{";
        }

        nav>a::after {
            color: var(--text);
            padding-left: 2px;
            font-size: 110%;
            content: "}";
        }

        .note {
            font-size: 75%;
            display: inline-block;
            transform: translateY(-0.4em);
        }

        .note::before {
            color: var(--text);
            content: "(";
        }

        .note::after {
            color: var(--text);
            content: ")";
        }

        .profile-picture {
            float: right;
            width: 38%;
            margin: 1.5em;
            margin-top: 0;
            margin-right: 0;
            text-align: left;
            font-size: 90%;
        }

        .profile-picture>img {
            height: auto;
        }

        figcaption {
            color: var(--subtext);
        }

        #back {
            display: none;
            pointer-events: none;
            opacity: 0;
            background-color: var(--primary);
            width: 4em;
            height: 4em;
            border-radius: 50%;
            position: fixed;
            bottom: 1em;
            right: 1em;
            z-index: 100;
            cursor: pointer;
            transition: opacity 0.5s ease-in-out;
            justify-content: center;
            align-items: center;
        }

        #back>div {
            border: solid var(--secondary);
            border-width: 0 10px 10px 0;
            display: inline-block;
            padding: 5px;
            transform: rotate(-135deg);
            -webkit-transform: rotate(-135deg);
            pointer-events: none;
        }

        #online-status {
            display: flex;
            flex-direction: row;
            justify-content: center;
            margin-top: 1em;
            gap: 20px;
        }

        #online-status>div {
            --height: 92px;
            --gap: 1em;
            display: none;
            max-width: min(95%, 390px);
            min-width: min(95%, 300px);
            width: max-content;
            height: var(--height);
            overflow: hidden;
            font-size: 14px;
        }

        #online-status>div>img {
            height: var(--height);
            width: var(--height);
            float: left;
            border-radius: 8px;
            margin-right: var(--gap);
        }

        #online-status>div>div {
            float: left;
            max-width: calc(100% - var(--height) - var(--gap));
            width: 100%;
        }

        #online-status>div>div>span {
            display: block;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
            width: max-content;
            max-width: 101%;
        }

        #spotify-progress {
            width: 100%;
            height: 4px;
            margin-top: 4px;
            border-radius: 2px;
            background-color: var(--secondary);
        }

        #spotify-progress>div {
            height: 4px;
            border-radius: 2px;
            background-color: var(--primary);
        }

        #discord {
            display: inline-block;
            border-radius: 50%;
            background-color: #11111b;
            aspect-ratio: 1/1;
            width: 1em;
            align-self: center;
        }

        @media screen and (max-width: 800px) {
            .profile-picture {
                float: none;
                width: 100%;
                margin: 0;
                margin-top: 8px;
                text-align: center;
                font-size: 100%;
            }

            .profile-container {
                display: flex;
                flex-direction: column-reverse;
            }

            #back {
                display: flex;
            }

            #online-status {
                flex-direction: column;
                align-items: center;
            }

            #online-status>div {
                width: 95%;
            }
        }
    </style>

    <script defer type="module">
        console.log("Hello, World!");

        document.getElementById("age").innerText = ((new Date() - new Date("2004-12-08T17:00:00.000+03:00")) / 1000 / 60 / 60 / 24 / 365.25).toFixed(2);

        const backToTopBtn = document.getElementById("back");
        const nav = document.querySelector("nav");

        const observer = new IntersectionObserver((entries) => {
            entries.forEach((entry) => {
                if (entry.isIntersecting) {
                    backToTopBtn.style.opacity = 0;
                    backToTopBtn.style.pointerEvents = "none"
                } else {
                    backToTopBtn.style.opacity = 1;
                    backToTopBtn.style.pointerEvents = "all"
                }
            });
        }, {
            root: null,
            rootMargin: "0px",
            threshold: 0.5
        });
        observer.observe(nav);

        backToTopBtn.addEventListener("click", () => {
            history.pushState({}, "", "")
            window.scrollTo({
                top: 0,
                behavior: "smooth"
            });
        });

        document.querySelectorAll("nav > a").forEach(el => {
            if (el.href.startsWith(window.location.origin)) {
                el.addEventListener("click", (e) => {
                    e.preventDefault();
                    const hash = "#" + el.href.split("#")[1];
                    history.pushState({}, "", hash)
                    document.querySelector(hash).scrollIntoView({
                        behavior: "smooth"
                    });
                });
            }
        })

        const discordEl = document.getElementById("discord");
        const discordExtraEl = document.getElementById("discord-extra");
        const spotifyEl = document.getElementById("spotify");
        const vscodeEl = document.getElementById("vscode");

        function sanitize(/** @type {string} */ str) {
            return str.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
        }

        function html(/** @type {string[]} */ strings, /** @type {unknown[]} */ ...values) {
            return strings.reduce((acc, str, i) => acc + str + (Boolean(values[i]) ? sanitize(String(values[i])) : ""), "");
        }

        function formatTime(/** @type {number} */ secs) {
            const hours = Math.floor(secs / 3600);
            const minutes = Math.floor(secs / 60) % 60;
            const seconds = secs % 60;
            return `${hours ? hours + ":" : ""}${hours && minutes < 10 ? "0" : ""}${minutes}:${seconds < 10 ? "0" : ""}${seconds}`;
        }

        const lanyardServer = "wss://lanyard.antti.codes/socket";
        const activityTarget = "312974985876471810";

        /** @type {number | null} */
        let discordRefreshTimeout = null;
        /** @type {WebSocket | null} */
        let discordWs = null;
        function listenForDiscord() {
            discordRefreshTimeout = null;
            discordWs = new WebSocket(lanyardServer);
            /** @type {number | null} */
            let wsHeartbeat = null;
            /** @type {number | null} */
            let vscodeElapsed = null;

            discordWs.onmessage = (/** @type {MessageEvent<any>} */ event) => {
                const { op, d: data } = JSON.parse(event.data);

                switch (op) {
                    case 1: {
                        if (wsHeartbeat) clearInterval(wsHeartbeat);
                        wsHeartbeat = setInterval(() => {
                            discordWs.send(JSON.stringify({ op: 3 }));
                        }, data.heartbeat_interval);
                        discordWs.send(JSON.stringify({
                            op: 2,
                            d: {
                                subscribe_to_id: activityTarget,
                            },
                        }));
                        break;
                    }

                    case 0: {
                        discordEl.style.backgroundColor = {
                            online: "#a6e3a1",
                            idle: "#fab387",
                            dnd: "#f38ba8",
                            offline: "#585b70",
                        }[data.discord_status];

                        if (data.active_on_discord_mobile && !(data.active_on_discord_desktop || data.active_on_discord_web)) {
                            discordExtraEl.innerHTML = html`
                                <span>&nbsp;on mobile</span>
                            `;
                        } else {
                            discordExtraEl.innerHTML = "";
                        }

                        const vscodeId = "383226320970055681";
                        const vscode = data.activities.find(activity => activity.application_id === vscodeId);

                        if (vscodeElapsed) clearInterval(vscodeElapsed);
                        if (vscode) {
                            vscodeEl.style.display = "block";
                            const elapsed = Math.floor((Date.now() - vscode.timestamps.start) / 1000);
                            vscodeEl.innerHTML = html`
                                <img src="https://cdn.discordapp.com/app-assets/${vscodeId}/${vscode.assets.large_image}.webp">
                                <div>
                                    <span><strong>Visual Studio Code</strong></span>
                                    <span>${vscode.details}</span>
                                    <span>${vscode.state}</span>
                                    <span>${formatTime(elapsed)} elapsed</span>
                                </div>
                            `;
                            vscodeElapsed = setInterval(() => {
                                const elapsed = Math.floor((Date.now() - vscode.timestamps.start) / 1000);
                                vscodeEl.children[1].children[3].innerText = formatTime(elapsed) + " elapsed";
                            }, 250);
                        } else {
                            vscodeEl.style.display = "none";
                        }
                        break;
                    }
                }
            };

            function close() {
                if (discordWs.readyState === WebSocket.OPEN) discordWs.close();
                if (wsHeartbeat) clearInterval(wsHeartbeat);
                if (vscodeElapsed) clearInterval(vscodeElapsed);
                if (!discordRefreshTimeout) discordRefreshTimeout = setTimeout(listenForDiscord, 3 * 1000);
            }

            discordWs.onerror = close;
            discordWs.onclose = close;
        }
        listenForDiscord();


        const statusServer = "wss://spotify.antti.codes";
        const spotifyTarget = "qgfht3wu1vo4ajn8skj9ugxem";

        /** @type {number | null} */
        let spotifyRefreshTimeout = null;
        /** @type {WebSocket | null} */
        let spotifyWs = null;
        let spotifyKilled = false;
        function listenForSpotify() {
            spotifyRefreshTimeout = null;
            spotifyWs = new WebSocket(statusServer);
            /** @type {number | null} */
            let wsHeartbeat = null;
            /** @type {number | null} */
            let spotifyProgress = null;

            spotifyWs.onmessage = (/** @type {MessageEvent<any>} */ event) => {
                const { op, d: data } = JSON.parse(event.data);

                switch (op) {
                    case 1: {
                        if (wsHeartbeat) clearInterval(wsHeartbeat);
                        wsHeartbeat = setInterval(() => {
                            spotifyWs.send(JSON.stringify({ op: 3 }));
                        }, data.heartbeat_interval);
                        spotifyWs.send(JSON.stringify({
                            op: 2,
                            d: spotifyTarget,
                        }));
                        break;
                    }

                    case 0: {
                        if (spotifyProgress) clearInterval(spotifyProgress);
                        if (data.is_playing) {
                            spotifyEl.style.display = "block";

                            let n = Date.now();
                            const progress = Math.floor((n - data.start * 1000) / 1000);
                            const progressPercentage = (progress / data.total * 100).toFixed(2);
                            spotifyEl.innerHTML = html`
                                <img src="${data.album_art}">
                                <div>
                                    <span>Listening to <a href="https://open.spotify.com/track/${data.track_id}"><i>${data.song}</i></a></span>
                                    <span>by <i>${data.artist.replaceAll(";", ",")}</i></span>
                                    <span>on <i>${data.album}</i></span>
                                    <div id="spotify-progress">
                                        <div style="width: ${progressPercentage}%"></div>
                                        <span style="float: left;">${formatTime(progress)}</span>
                                        <span style="float: right;">${formatTime(data.total)}</span>
                                    </div>
                                </div>
                            `;

                            spotifyProgress = setInterval(() => {
                                n = Date.now()
                                const progressBar = document.getElementById("spotify-progress");
                                const progress = Math.floor((n - data.start * 1000) / 1000);
                                const progressPercentage = (progress / data.total * 100).toFixed(2);

                                progressBar.innerHTML = html`
                                    <div style="width: ${progressPercentage}%"></div>
                                    <span style="float: left;">${formatTime(progress)}</span>
                                    <span style="float: right;">${formatTime(data.total)}</span>
                                `;
                            }, 250)
                        } else {
                            spotifyEl.style.display = "none";
                        }
                        break;
                    }

                    case 4: {
                        spotifyKilled = true;
                        console.error("SPOTIFY:", data);
                        break;
                    }
                }
            };

            function close() {
                if (spotifyWs.readyState === WebSocket.OPEN) spotifyWs.close();
                if (wsHeartbeat) clearInterval(wsHeartbeat);
                if (spotifyProgress) clearInterval(spotifyProgress);
                if (!spotifyRefreshTimeout && !spotifyKilled) spotifyRefreshTimeout = setTimeout(listenForSpotify, 3 * 1000);
            }

            spotifyWs.onerror = close;
            spotifyWs.onclose = close;
        }
        listenForSpotify();
    </script>
</head>

<body>
    <h1 id="top">antti.codes</h1>
    <nav>
        <a href="#who">Who</a>
        <a href="#contact">Contact</a>
        <a href="#projects">Projects</a>
        <a href="#services">Services</a>
        <a href="#communities">Communities</a>
        <a href="https://an.tti.sh/">Blog</a>
    </nav>
    <div id="online-status">
        <div id="spotify"></div>
        <div id="vscode"></div>
    </div>
    <div id="back">
        <div></div>
    </div>
    <h2 id="who">Who is this guy?</h2>
    <div class="profile-container">
        <figure class="profile-picture">
            <img src="./assets/profile_picture.jpg" alt="Picture of Antti" width="512" height="512">
            <figcaption>Picture of Antti from 2022-06-26</figcaption>
        </figure>
        <p>
            I'm just a dude from Finland ðŸ‡«ðŸ‡® who happens to like
            programming<span class="note">since 2016</span>
            and system administration<span class="note">since 2019</span>.
            At the moment <span id="age"></span> years old.
            Recently passed the Finnish Matriculation Examination and going to
            study computer science in the University of Oulu in late 2024.
            <br><br>
            I work as a full stack developer using JavaScript and TypeScript for everything.
            Be it backend, web, desktop, mobile, games or embedded.
            I do prefer the backend but for them to be useful, frontends are a necessary evil.
            Work is mostly freelancing, sometimes on a company payroll. Though most of my code
            is free and open source on GitHub, like all software should be.
            <br><br>
            As a sysadmin and linux hobbyist, I self-host a lot of services and
            spend too much money on domains and servers.
            I absolutely adore Docker<span class="note">and the whale</span> for my self-hosting needs.
            Still doing it just for my own benefit but who knows,
            maybe system administration could also be a future career path.
            I use arch btw.
        </p>
    </div>
    <h2 id="contact">Where can I find you?</h2>
    <p>
        If you want to use encryption here is my <a href="./pgpkey">PGP public key</a>
        and while we are at keys... here are my <a href="./sshkey">SSH public keys</a> as well.
    </p>
    <ul>
        <li>
            <div>
                <span>Discord:&nbsp;</span>
                <code>@antticodes</code>
                <span>&nbsp;</span>
                <div id="discord"></div>
                <div id="discord-extra"></div>
            </div>
        </li>
        <li>Email: <a href="mailto:antti@antti.codes"><code>antti@antti.codes</code></a></li>
        <li>GitHub: <a href="https://github.com/Chicken"><code>Chicken</code></a></li>
        <li>Telegram: <a href="https://t.me/antti_e"><code>antti_e</code></a></li>
        <li>Matrix: <a href="https://matrix.to/#/@antti:antti.codes"><code>@antti:antti.codes</code></a></li>
        <li>Twitter: <a href="https://twitter.com/antticodes"><code>@antticodes</code></a></li>
        <li>LinkedIn: <a href="https://linkedin.com/in/antti-ellila"><code>antti-ellila</code></a></li>
    </ul>
    <h2 id="what">What can you do?</h2>
    <p>
        I think a better question would be what I can't do. <br />
        But if you insist here is a short and concise list of some of my skills. <br />
        <br />
        Languages: JavaScript, TypeScript, Node.js, Deno, HTML, CSS, Python, Java, Rust <br />
        Libraries: Express.js, React.js, Next.js, Discord.js, Vite, TailwindCSS, Prisma <br />
        Databases: Sqlite, MariaDB, PostgreSQL <br />
        Editors: VSCode, Nano <br />
        Operating systems: ArchLinux, Debian <br />
        Sysadmin: Docker, Nginx, Cloudflare, Netdata, Bash, DNS, Email <br />
        Other: Git, GitHub, GitHub Actions, GitLab, GitLab CI/CD, Grafana <br />
        <br />
        If you were expecting one of those cool icon grids, I'm sorry to disappoint you.
        I put off making this list for like half a year.
        Even now I could only gather enough motivation to create this.
    </p>
    <h2>What have you done?</h2>
    <h3 id="projects">Projects</h3>
    <ul>
        <li><a href="https://github.com/Chicken/Auth">Minecraft Web Authentication</a></li>
        <li><a href="https://github.com/Chicken/DoorLock-Legacy">Electronic Door Lock</a></li>
        <li><a href="https://github.com/Chicken/BlueMap-Towny">BlueMap Towny Integration</a></li>
        <li><a href="https://github.com/Chicken/qbit.js">JavaScript library for qBittorrent web api</a></li>
        <li><a href="https://github.com/Chicken/WeatherApi">Weather station</a></li>
        <li><a href="https://github.com/Chicken/aur-osu-bumper">Automated AUR updates via Discord</a></li>
    </ul>
    <p>
        <!-- TODO: populate this section -->
        And see the rest on <a href="https://github.com/Chicken/">GitHub</a>.
        <br>
        Sadly I can't publish projects made for a client or an employer.
    </p>
    <h3 id="services">Services</h3>
    <ul>
        <li><a href="https://antti.link/">URL shortener</a></li>
        <li><a href="https://whois.antti.codes/">Domain Whois</a></li>
        <li><a href="https://vault.antti.codes/">Bitwarden</a></li>
        <li><a href="https://grafana.antti.codes/">Grafana</a></li>
        <li><a href="https://cloud.antti.codes/">Nextcloud</a></li>
        <li><a href="https://mail.antti.codes/">Email</a></li>
        <li><a href="https://matrix.antti.codes/">Matrix</a></li>
        <li><a href="https://jellyfin.antti.codes/">Jellyfin</a></li>
        <li><a href="https://cast.antti.codes/">Owncast</a></li>
    </ul>
    <p>You can find more on my <a href="https://status.antti.codes/">statuspage</a>.</p>
    <h3 id="communities">Communities</h3>
    <p>Places where I'm involved</p>
    <ul>
        <li><a href="https://testausserveri.fi/">Testausserveri</a> - Vice Chairman of the Board and system
            administrator</li>
        <li><a href="https://globecraft.xyz/">Globecraft</a> - Developer</li>
        <li><a href="https://bluemap.bluecolored.de/">BlueMap</a> - Assistant</li>
        <li><a href="https://github.com/IIoW">IIslands Of War</a> - "Mini" Dev</li>
    </ul>
</body>

</html>
